---
layout: post
title: "[swift] ì•„í´ë¡œ ì„œë²„ì™€ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ êµ¬í˜„ ë°©ë²•"
description: " "
date: 2023-11-15
tags: [swift]
comments: true
share: true
---

## ì†Œê°œ
ì´ë²ˆ ë¸”ë¡œê·¸ì—ì„œëŠ” ì•„í´ë¡œ ì„œë²„ì™€ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. ì•„í´ë¡œ ì„œë²„ëŠ” GraphQLì„ ìœ„í•œ ê°•ë ¥í•œ ë„êµ¬ë¡œ, ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë° íŠ¹íˆ ì í•©í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  í™”ë©´ì— ë³´ì—¬ì¤„ ìˆ˜ ìˆëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ì—ì„œëŠ” Swift ì–¸ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì•„í´ë¡œ ì„œë²„ì˜ ì‹¤ì‹œê°„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œ ì˜ˆì œ ì½”ë“œë¥¼ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.

## ì „ì œ ì¡°ê±´
ì´ ì˜ˆì œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒì˜ ì „ì œ ì¡°ê±´ì´ í•„ìš”í•©ë‹ˆë‹¤:

1. Swift ì–¸ì–´ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
2. Node.jsì™€ npmì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
3. Apollo Serverë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ npm íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ë¥¼ ì‚¬ìš©í•  ì¤„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.

## ì•„í´ë¡œ ì„œë²„ ì„¤ì •í•˜ê¸°
ì•„í´ë¡œ ì„œë²„ë¥¼ ì„¤ì •í•˜ë ¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë”°ë¥´ì„¸ìš”:

1. í”„ë¡œì íŠ¸ í´ë”ë¥¼ ë§Œë“¤ê³  í•´ë‹¹ í´ë”ì— ì´ë™í•˜ì„¸ìš”.
2. í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•„í´ë¡œ ì„œë²„ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤:

   ```shell
   $ npm install apollo-server graphql
   ```

3. ì„œë²„ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•´ `index.js` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”:

   ```javascript
   const { ApolloServer, PubSub } = require('apollo-server');
   const pubsub = new PubSub();

   const typeDefs = `
     type Counter {
       value: Int!
     }

     type Query {
       counter: Counter!
     }

     type Subscription {
       countUpdated: Counter!
     }
   `;

   const resolvers = {
     Query: {
       counter: () => ({ value: 0 }),
     },
     Subscription: {
       countUpdated: {
         subscribe: () => pubsub.asyncIterator(['COUNTER_UPDATED']),
       },
     },
   };

   const server = new ApolloServer({
     typeDefs,
     resolvers,
   });

   server.listen().then(({ url }) => {
     console.log(`ğŸš€ Server ready at ${url}`);
   });
   ```

4. í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤:

   ```shell
   $ node index.js
   ```

ì´ì œ ì•„í´ë¡œ ì„œë²„ê°€ ì‹¤í–‰ë˜ê³ , `http://localhost:4000`ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

## í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‘ì„±í•˜ê¸°
ì´ì œ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œë¥¼ ë³´ì—¬ì£¼ëŠ” Swift ê¸°ë°˜ì˜ í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‘ì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.

1. í”„ë¡œì íŠ¸ í´ë” ë‚´ì— `Podfile`ì„ ìƒì„±í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”:

   ```ruby
   # Uncomment the next line to define a global platform for your project
   # platform :ios, '9.0'

   target 'YourAppName' do
     # Comment the next line if you don't want to use dynamic frameworks
     use_frameworks!

     # Pods for YourAppName
     pod 'Apollo', '0.19.0'
   end
   ```

2. í„°ë¯¸ë„ì—ì„œ í”„ë¡œì íŠ¸ í´ë” ë‚´ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ CocoaPodsì„ ì„¤ì¹˜í•˜ì„¸ìš”:

   ```shell
   $ pod install
   ```

3. `YourAppName.xcworkspace` íŒŒì¼ì„ ì—´ì–´ Xcodeì—ì„œ í”„ë¡œì íŠ¸ë¥¼ ì—´ì–´ì£¼ì„¸ìš”.
4. `AppDelegate.swift` íŒŒì¼ì„ ì—´ê³  ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì„¸ìš”:

   ```swift
   import Apollo

   let apollo = ApolloClient(url: URL(string: "http://localhost:4000")!)
   ```

5. ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œë¥¼ ë³´ì—¬ì¤„ ViewController íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”:

   ```swift
   import UIKit
   import Apollo

   class DashboardViewController: UIViewController {

       var counterSubscription: Cancellable?
       @IBOutlet weak var counterLabel: UILabel!

       override func viewDidLoad() {
           super.viewDidLoad()
           subscribeToCounterUpdates()
       }

       func subscribeToCounterUpdates() {
           counterSubscription = apollo.subscribe(subscription: CountUpdatedSubscription()) { [weak self] result in
               switch result {
               case .success(let graphQLResult):
                   if let counterValue = graphQLResult.data?.countUpdated.value {
                       self?.counterLabel.text = "\(counterValue)"
                   }
               case .failure(let error):
                   print("Failed to update counter: \(error)")
               }
           }
       }

       deinit {
           counterSubscription?.cancel()
       }

   }
   ```

6. Main.storyboard íŒŒì¼ì„ ì—´ê³  ë·° ì»¨íŠ¸ë¡¤ëŸ¬ì— UILabelì„ ì¶”ê°€í•˜ê³  IBOutletì„ ì—°ê²°í•©ë‹ˆë‹¤.
7. ì‹¤í–‰í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œì˜ ìˆ«ìê°€ ì—…ë°ì´íŠ¸ë˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

## ê²°ë¡ 
ì´ë²ˆ ë¸”ë¡œê·¸ì—ì„œëŠ” ì•„í´ë¡œ ì„œë²„ì™€ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. Swift ì–¸ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì•„í´ë¡œ ì„œë²„ì˜ ì‹¤ì‹œê°„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“œëŠ” ì˜ˆì œ ì½”ë“œë¥¼ ì œê³µí–ˆìŠµë‹ˆë‹¤. ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ëŠ” ê²½ìš°, ì•„í´ë¡œ ì„œë²„ì™€ ì‹¤ì‹œê°„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•´ë³´ì„¸ìš”.