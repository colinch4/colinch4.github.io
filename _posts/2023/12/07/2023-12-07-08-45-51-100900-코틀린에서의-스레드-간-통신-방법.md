---
layout: post
title: "[kotlin] ì½”í‹€ë¦°ì—ì„œì˜ ìŠ¤ë ˆë“œ ê°„ í†µì‹  ë°©ë²•"
description: " "
date: 2023-12-07
tags: [kotlin]
comments: true
share: true
---

ì½”í‹€ë¦°ì€ ìë°”ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ìŠ¤ë ˆë“œ ê°„ì˜ íš¨ìœ¨ì ì¸ í†µì‹ ì€ ì¤‘ìš”í•œ ê³¼ì œ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì´ë²ˆ ê¸€ì—ì„œëŠ” ì½”í‹€ë¦°ì—ì„œ ìŠ¤ë ˆë“œ ê°„ í†µì‹ ì„ í•˜ëŠ” ëª‡ ê°€ì§€ ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

## 1. ê³µìœ  ë³€ìˆ˜ ì‚¬ìš©

ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ ìŠ¤ë ˆë“œ ê°„ì— ê³µìœ  ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê³µìœ  ë³€ìˆ˜ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë³€ìˆ˜ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ì½”í‹€ë¦°ì—ì„œëŠ” `Atomic` íƒ€ì… ë³€ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

ë‹¤ìŒì€ `AtomicInteger`ë¥¼ ì‚¬ìš©í•œ ì˜ˆì‹œì…ë‹ˆë‹¤.

```kotlin
import java.util.concurrent.atomic.AtomicInteger

fun main() {
    val sharedVariable = AtomicInteger(0)
    
    val thread1 = Thread {
        for (i in 1..1000) {
            sharedVariable.incrementAndGet()
        }
    }
    
    val thread2 = Thread {
        for (i in 1..1000) {
            sharedVariable.incrementAndGet()
        }
    }
    
    thread1.start()
    thread2.start()
    
    thread1.join()
    thread2.join()
    
    println("Result: ${sharedVariable.get()}")
}
```

ì´ ì˜ˆì œëŠ” `AtomicInteger`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ê°œì˜ ìŠ¤ë ˆë“œê°€ ê³µìœ  ë³€ìˆ˜ë¥¼ ë™ì‹œì— ì¦ê°€ì‹œí‚¤ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. `AtomicInteger`ëŠ” ì›ìì  ì—°ì‚°ì„ ì§€ì›í•˜ë¯€ë¡œ ì •í™•í•œ ê²°ê³¼ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.

## 2. ë½ ì‚¬ìš©

ë½ì€ ìŠ¤ë ˆë“œ ê°„ì˜ ë™ê¸°í™” ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. í¬ë¦¬í‹°ì»¬ ì„¹ì…˜ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ì½”ë“œ ì˜ì—­ì„ í•œ ë²ˆì— í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ì‹¤í–‰í•˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ì½”í‹€ë¦°ì—ì„œëŠ” `synchronized` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë½ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ `synchronized` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•œ ì˜ˆì‹œì…ë‹ˆë‹¤.

```kotlin
fun main() {
    val sharedVariable = 0
    val lock = Object()
    
    val thread1 = Thread {
        synchronized(lock) {
            for (i in 1..1000) {
                sharedVariable++
            }
        }
    }
    
    val thread2 = Thread {
        synchronized(lock) {
            for (i in 1..1000) {
                sharedVariable++
            }
        }
    }
    
    thread1.start()
    thread2.start()
    
    thread1.join()
    thread2.join()
    
    println("Result: $sharedVariable")
}
```

ì´ ì˜ˆì œëŠ” `synchronized` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê³µìœ  ë³€ìˆ˜ì— ì ‘ê·¼í•˜ëŠ” ì½”ë“œ ì˜ì—­ì„ ë™ê¸°í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë½ì„ ì–»ì€ ìŠ¤ë ˆë“œë§Œ í•´ë‹¹ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³ , ë‹¤ë¥¸ ìŠ¤ë ˆë“œëŠ” ëŒ€ê¸° ìƒíƒœë¡œ ë“¤ì–´ê°‘ë‹ˆë‹¤.

## 3. ë©”ì‹œì§€ í ì‚¬ìš©

ë©”ì‹œì§€ íëŠ” ìŠ¤ë ˆë“œ ê°„ í†µì‹ ì„ ìœ„í•œ ë” ë³µì¡í•œ ë°©ë²• ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì½”í‹€ë¦°ì—ì„œëŠ” `BlockingQueue` ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ íë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ìŠ¤ë ˆë“œ ê°„ì— ë©”ì‹œì§€ë¥¼ ì£¼ê³  ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ `BlockingQueue`ë¥¼ ì‚¬ìš©í•œ ì˜ˆì‹œì…ë‹ˆë‹¤.

```kotlin
import java.util.concurrent.ArrayBlockingQueue

fun main() {
    val messageQueue = ArrayBlockingQueue<String>(10)
    
    val producer = Thread {
        for (i in 1..10) {
            val message = "Message $i"
            messageQueue.put(message)
            println("Produced: $message")
        }
    }
    
    val consumer = Thread {
        for (i in 1..10) {
            val message = messageQueue.take()
            println("Consumed: $message")
        }
    }
    
    producer.start()
    consumer.start()
    
    producer.join()
    consumer.join()
}
```

ì´ ì˜ˆì œì—ì„œëŠ” `ArrayBlockingQueue`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ íë¥¼ ìƒì„±í•˜ê³ , í”„ë¡œë“€ì„œ ìŠ¤ë ˆë“œì™€ ì»¨ìŠˆë¨¸ ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ì–´ ë©”ì‹œì§€ë¥¼ ì£¼ê³  ë°›ê³  ìˆìŠµë‹ˆë‹¤.

## ë§ˆì¹˜ë©°

ì´ë²ˆ ê¸€ì—ì„œëŠ” ì½”í‹€ë¦°ì—ì„œì˜ ìŠ¤ë ˆë“œ ê°„ í†µì‹  ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ê³µìœ  ë³€ìˆ˜, ë½, ë©”ì‹œì§€ íë¥¼ í™œìš©í•˜ì—¬ ìŠ¤ë ˆë“œ ê°„ì— ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„ íƒí•œ ë°©ë²•ì€ í”„ë¡œì íŠ¸ì˜ ìš”êµ¬ì‚¬í•­ê³¼ ìƒí™©ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì ì ˆíˆ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.

## ğŸ“š ì°¸ê³  ìë£Œ
- [Kotlin ê³µì‹ ë¬¸ì„œ](https://kotlinlang.org/docs/home.html)
- [Java Concurrency in Practice](https://www.oreilly.com/library/view/java-concurrency-in/9780133065269/)