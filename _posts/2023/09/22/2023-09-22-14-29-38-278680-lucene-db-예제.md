---
layout: post
title: "lucene db ì˜ˆì œ"
description: " "
date: 2023-09-22
tags: [lucene]
comments: true
share: true
---

ì´ ì˜ˆì œì—ì„œëŠ” Luceneì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. Luceneì€ ê²€ìƒ‰ ë° ìƒ‰ì¸í™” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ê²€ìƒ‰ ì—”ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  ìƒ‰ì¸í™”í•˜ê³  ì‹¶ì„ ë•Œ Luceneì„ ì‚¬ìš©í•˜ë©´ íš¨ìœ¨ì ì¸ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì œê³µë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Lucene DB êµ¬í˜„í•˜ê¸°

1. ë¨¼ì € Luceneì˜ ìµœì‹  ë²„ì „ì„ ë‹¤ìš´ë¡œë“œí•˜ê³  í”„ë¡œì íŠ¸ì— ì¶”ê°€í•©ë‹ˆë‹¤.

2. ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•  ìŠ¤í‚¤ë§ˆë¥¼ ì •ì˜í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì±…ì˜ ì œëª©(title)ê³¼ ì €ì(author), ì¶œíŒì¼(publish_date) ë“±ì˜ ì†ì„±ì„ ê°€ì§„ ë„íë¨¼íŠ¸(document)ë¥¼ ìƒì„±í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```java
public class Book {
    private String title;
    private String author;
    private Date publishDate;

    // ìƒì„±ì, getter/setter ìƒëµ

    public Document toDocument() {
        Document document = new Document();
        document.add(new TextField("title", title, Field.Store.YES));
        document.add(new TextField("author", author, Field.Store.YES));
        document.add(new StringField("publish_date", DateTools.dateToString(publishDate, DateTools.Resolution.DAY), Field.Store.YES));
        return document;
    }
}
```

3. ë°ì´í„°ë² ì´ìŠ¤ì— ë„íë¨¼íŠ¸ë¥¼ ìƒ‰ì¸í™”í•©ë‹ˆë‹¤. ì´ë•Œ, ê° ë„íë¨¼íŠ¸ëŠ” ìœ ì¼í•œ IDë¥¼ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Book ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë§Œë“¤ê³  ë„íë¨¼íŠ¸ë¥¼ ìƒ‰ì¸í™”í•˜ê¸° ìœ„í•œ ë‹¤ìŒ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```java
public void indexDocument(Book book) {
    try {
        IndexWriterConfig config = new IndexWriterConfig(new StandardAnalyzer());
        IndexWriter writer = new IndexWriter(FSDirectory.open(new File("index")), config);
        writer.addDocument(book.toDocument());
        writer.close();
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

4. ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ì—¬ ê²°ê³¼ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, "Lucene"ì´ë¼ëŠ” ë‹¨ì–´ë¥¼ í¬í•¨í•˜ëŠ” ì±…ì„ ê²€ìƒ‰í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ê²€ìƒ‰ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```java
public List<Book> searchBooks(String searchText) {
    List<Book> results = new ArrayList<>();

    try {
        IndexReader reader = DirectoryReader.open(FSDirectory.open(new File("index")));
        IndexSearcher searcher = new IndexSearcher(reader);
        Analyzer analyzer = new StandardAnalyzer();
        QueryParser parser = new QueryParser("title", analyzer);
        Query query = parser.parse(searchText);
      
        TopDocs topDocs = searcher.search(query, 10);
        ScoreDoc[] hits = topDocs.scoreDocs;
        for (ScoreDoc hit : hits) {
            Document document = searcher.doc(hit.doc);
            Book book = convertDocumentToBook(document);
            results.add(book);
        }
      
        reader.close();
    } catch (IOException | ParseException e) {
        e.printStackTrace();
    }
    
    return results;
}

private Book convertDocumentToBook(Document document) {
    String title = document.get("title");
    String author = document.get("author");
    Date publishDate = DateTools.stringToDate(document.get("publish_date"));
    // Book ê°ì²´ ìƒì„± ë° ë°˜í™˜
}
```

## ë§ˆë¬´ë¦¬

Luceneì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê°„ë‹¨í•œ ì˜ˆì œë¥¼ ì†Œê°œí–ˆìŠµë‹ˆë‹¤. Luceneì€ ê°•ë ¥í•œ ê²€ìƒ‰ ë° ìƒ‰ì¸í™” ê¸°ëŠ¥ì„ ì œê³µí•˜ë¯€ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê³  ê²€ìƒ‰í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ì´ ì˜ˆì œë¥¼ ì°¸ê³ í•˜ì—¬ í”„ë¡œì íŠ¸ì— Luceneì„ ì ìš©í•´ë³´ì„¸ìš”. Happy coding! ğŸ˜Š

#Lucene #ë°ì´í„°ë² ì´ìŠ¤ #ê²€ìƒ‰ì—”ì§„