---
layout: post
title: "[spring] RESTful API ì‚¬ìš©í•˜ê¸°"
description: " "
date: 2021-06-07
tags: [spring]
comments: true
share: true
---

## ğŸ“© RESTful API ì‚¬ìš©í•˜ê¸° ğŸ“¬

[ëª©í‘œ]

- RESTfulí•˜ê²Œ ì›¹ í˜ì´ì§€ urlì„ ì„¤ì •í•˜ê¸°
- JSON ë°ì´í„°ì— ì ‘ê·¼í•˜ì—¬ CRUD ì‹¤í–‰í•˜ê¸°

<br>

### REST (REpresentational State Transfer)ì´ë€?

> - **HTTP URI + HTTP Method**
> - HTTP URIë¥¼ í†µí•´ ì œì–´í•  ë¦¬ì†ŒìŠ¤ë¥¼ ëª…ì‹œí•˜ê³ , HTTP Method(GET, POST, PUT, DELETE)ë¥¼ í†µí•´ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ ì œì–´í•˜ëŠ” ì•„í‚¤í…ì³
> - HTTP í”„ë¡œí† ì½œì— ì •ì˜ëœ POST, GET, PUT, DELETEê°€ ê°ê° CRUD ì˜¤í¼ë ˆì´ì…˜ ì •ì˜

**URI(Uniform Resource Identifier)ë€?** ì¸í„°ë„· ìì›ì˜ ìœ„ì¹˜ ì¦‰ íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ìœ ì¼í•œ ì£¼ì†Œ (URL, URLì„ í†µì¹­í•˜ëŠ” ê°œë…)

<br>

### RESTful APIë€?

> - RESTì˜ ì›ë¦¬ë¥¼ ë”°ë¥´ëŠ” API
> - ê° ìš”ì²­ì´ ì–´ë–¤ ë™ì‘ì´ë‚˜ ì •ë³´ë¥¼ ìœ„í•œ ê²ƒì¸ì§€ ëª…ì‹œì ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆê²Œ í•¨
> - HTTPì™€ URIê¸°ë°˜ìœ¼ë¡œ ìì›ì— ì ‘ê·¼í• ìˆ˜ ìˆë„ë¡ ì œê³µí•˜ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ì¸í„°í˜ì´ìŠ¤
> - ì¼ê´€ì„±ìˆê²Œ ì•¡ì…˜ê³¼ ë¦¬ì†ŒìŠ¤ ì •ë³´ë¥¼ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŒ

<br>

[ê¸€ ë²ˆí˜¸ê°€ 510ì´ê³  ì´ë¦„ì´ javaì¸ ê²Œì‹œê¸€ì„ ì§€ìš°ëŠ” ë°©ë²• ë¹„êµ]

| ê¸°ì¡´ ì›¹ ì ‘ê·¼ë°©ì‹                  | RESTful API                         |
| --------------------------------- | ----------------------------------- |
| url : /delete.do?no=510&name=java | url : /bbs/java/510                 |
| -GET / POST ë°©ì‹ë§Œìœ¼ë¡œ CRUD í‘œí˜„  | GET/POST/PUT/DELETE ë§¤ì†Œë“œ ëª¨ë‘ì‚¬ìš© |
| URI: ì•¡ì…˜ì„ ë‚˜íƒ€ëƒ„                | URI : ì²˜ë¦¬í•˜ë ¤ëŠ” ìì› ë‚˜íƒ€ëƒ„        |

<br>

### Open APIë€?

> - ì–´í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì œê³µë˜ëŠ” ê°œë°©í˜• API
> - ëŒ€ë¶€ë¶„ì˜ Open APIëŠ” REST ë°©ì‹ìœ¼ë¡œ ì§€ì›
> - **API (Application Programing Interface) ?** í”„ë¡œê·¸ë¨ ê°œë°œ ì‹œ ì‚¬ìš©í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ ì„œë²„ì™€ DBì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì¶œì…êµ¬ ì—­í• ì„ í•¨

<br >

### JSONì´ë€?

> - Javascript Object Notation
> - ì¡°ê¸ˆ ë” ì‰½ê³  ê°€ë³ê²Œ ë°ì´í„°ë¥¼ êµí™˜í•  ìˆ˜ ìˆëŠ” í˜•ì‹
> - ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ê°ì²´ë¥¼ ë§Œë“¤ ë•Œ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì‹ ì‚¬ìš© {key: value}
> - ì‚¬ëŒê³¼ ê¸°ê³„ ëª¨ë‘ ì´í•´í•˜ê¸° ì‰½ê³  ìš©ë ¹ì´ ì‘ì•„ì„œ XML ëŒ€ì²´ë¡œ ë§ì´ ì´ìš©ë¨
> - íŠ¹ì • ì–¸ì–´ì— ì¢…ì†ë˜ì§€ ì•Šê³  ëŒ€ë¶€ë¶„ì˜ í”„ë¡œê·¸ë˜ë°ì–¸ì–´ì—ì„œ JSON ë°ì´í„°ë¥¼ í•¸ë“¤ë§í•  ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì œê³µ

<br>

[JSON ë°ì´í„° ì˜ˆì‹œ]

```javascript
{
    "userId": "Lee",
    "name": "hyori",
    "gender": "F",
    "city": "Jeju"
}

```

![](./imgs/mvc/json.png)

<br><br>

### ğŸ§º Spring MVC ê¸°ë°˜ìœ¼ë¡œ RESTful ì›¹ ì„œë¹„ìŠ¤ êµ¬í˜„í•˜ê¸°

#### 0. í™˜ê²½ì„¤ì •í•˜ê¸°

> 1. mvc:default ê°’ì„ ì„¤ì •í•´ì¤˜ì„œ ë°”ê¾¼ DispatcherServletì˜ url-patternì™€ ì¶©ëŒì´ ë‚˜ì§€ ì•Šë„ë¡ í•¨
> 2. JSONê³¼ XMLë°ì´í„°ë¥¼ ì½ê³  ì“°ëŠ” ê²ƒì„ ë‚´ë¶€ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” annotaion-drivenì„¤ì •
> 3. Jackson ì„¤ì¹˜: JSON í˜•íƒœë¥¼ ìë°”ê°ì²´ë¡œ / ìë°”ë¥¼ JSON í˜•íƒœë¡œ ë°”ê¿”ì£¼ëŠ” ìë°” ë¼ì´ë¸ŒëŸ¬ë¦¬

<br>

**[pom.xml]** jackonì˜ì¡´ì„± ì¶”ê°€

```xml
<!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind -->
<dependency>
	<groupId>com.fasterxml.jackson.core</groupId>
	<artifactId>jackson-databind</artifactId>
	<version>2.11.2</version>
</dependency>

```

```xml
	<!-- DispatcherServletì˜ url-patternì¶©ëŒ ë¬¸ì œ í•´ê²° -->
	<mvc:default-servlet-handler/>
	<!-- JSON, XML Data read/write support -->
	<mvc:annotation-driven />
```

**[web.xml]**

> - RESTfulí•œ êµ¬ì„±ì„ ìœ„í•´ [web.xml]ì˜ DispatcherServlet url-patternì„ ë³€í˜•

[ì´ì „ web.xml]

```xml
  <servlet-mapping>
    <servlet-name>springDispatcherServlet</servlet-name>
    <url-pattern>*.do</url-pattern>
  </servlet-mapping>
```

[ë°”ê¾¼ web.xml]

```xml
  <servlet-mapping>
    <servlet-name>springDispatcherServlet</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping>
```

<br>

#### 1. RESTful ì›¹ ì„œë¹„ìŠ¤ë¥¼ ì²˜ë¦¬í•  Controller í´ë˜ìŠ¤ ì‘ì„±

| ì–´ë…¸í…Œì´ì…˜      | ê¸°ëŠ¥                                                                                                                                                           |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| @RestController | - @Controllerì™€ @Responsebodyì˜ ê¸°ëŠ¥ì„ í•©ì³ë†“ì€ ê²ƒ                                                                                                             |
| @RequestBody    | - HTTP ìš”ì²­ bodyë¥¼ ìë°”ê°ì²´ë¡œ ì „ë‹¬ ë°›ìŒ <br> - ì¸ìë¥¼ bodyí˜•íƒœë¡œ ë°›ì•„ì˜¤ê¸° ë•Œë¬¸ì— POSTí˜•íƒœë¡œë§Œ ì‚¬ìš© <br> - Jacksonì´ ì „ë‹¬ë°›ì€ ê°ì²´ë¥¼ JSONìœ¼ë¡œ ë³€í™˜í•´ì„œ ë‚´ë³´ë‚´ì¤Œ |
| @RequestMapping | - HTTP ìš”ì²­ì„ ì²˜ë¦¬í•  ë§¤ì†Œë“œë¥¼ ë§¤í•‘í•´ì¤Œ <br > - í´ë˜ìŠ¤, ë§¤ì†Œë“œ ìœ„ì— ì‚¬ìš© ê°€ëŠ¥                                                                                   |
| @GetMapping     | - Get ìš”ì²­ì„ ì²˜ë¦¬ í•  ë§¤ì†Œë“œë¥¼ ë§¤í•‘ <br> - @RequestBodyì™€ ê°™ì€ ì—­í• ì´ì§€ë§Œ ë§¤ì†Œë“œ ìœ„ì—ë§Œ ì‚¬ìš© ê°€ëŠ¥                                                               |
| @PostMapping    | - Post ìš”ì²­ì„ ì²˜ë¦¬í•  ë§¤ì†Œë“œ ë§¤í•‘                                                                                                                               |
| @PutMapping     | - Put ìš”ì²­ (update)ì²˜ë¦¬í•  ë§¤ì†Œë“œ ë§¤í•‘                                                                                                                          |
| @DeleteMapping  | - Delete ìš”ì²­ ì²˜ë¦¬í•  ë§¤ì†Œë“œ ë§¤í•‘                                                                                                                               |
| @PathVariable   | - íŒŒë¼ë¯¸í„°ë¥¼ URL ë‚´ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë°›ì•„ì¤Œ                                                                                                           |

<br>

[RESTUserController.java]

```java

@RestController
public class RESTUserController {

		@Autowired
		private UserService userService;

		@RequestMapping("/users/{userid}")

		//ë°›ì•„ì˜¬ ì¸ìê°’ì´ String useridë¡œ ì´ë¦„ì„ ë§ì¶”ì§€ ì•Šìœ¼ë©´ @PathVariable(ì„¤ì •í•œ ì´ë¦„)ë¡œ ë§ì¶°ì¤˜ì•¼í•¨
		public UserVO getUser(@PathVariable String userid) {
			UserVO user = userService.getUser(userid);
			return user;
		}

		@GetMapping("/users")
		public List<UserVO> getUsers(){
			 List<UserVO> userList = userService.getUserList();
			 return userList;
		}

		@PostMapping("/users")
		public Boolean insertUser(@RequestBody UserVO user) {
			if(user !=null) {
				userService.insertUser(user);
				return Boolean.TRUE;
			}else {
				return Boolean.FALSE;
			}
		}

		@PutMapping("/users")
		public Boolean updateUser(@RequestBody UserVO user) {
			if(user!=null) {
				userService.updateUser(user);
				return Boolean.TRUE;
			}else {
				return Boolean.FALSE;
			}

		}

		@DeleteMapping("/users/{id}")
		public Boolean deleteUser(@PathVariable("id") String userid) {
			if(userid!=null) {
				userService.deleteUser(userid);
				return Boolean.TRUE;
			}else {
				return Boolean.FALSE;
			}
		}
}

```

<br>

#### 2. RESTfulí•˜ê²Œ ë°ì´í„°ë¥¼ ì½ì–´ì˜¤ëŠ”ì§€ í™•ì¸

[ìœ ì € ë¦¬ìŠ¤íŠ¸ ì „ì²´ ë°›ì•„ì˜¤ê¸°]

```java
@GetMapping("/users")
    public List<UserVO> getUsers(){
	List<UserVO> userList = userService.getUserList();
	return userList;
}
```

![](./imgs/mvc/json_list.png)

<br>

[íŠ¹ì • ìœ ì € ë°›ì•„ì˜¤ê¸° ]

```java
@RequestMapping("/users/{userid}")
    public UserVO getUser(@PathVariable String userid) {
	UserVO user = userService.getUser(userid);
	return user;
}
```

![](./imgs/mvc/json_get.png)
<br>

#### 3. REST Client Tool(Postman)ì‚¬ìš©, ê°ê°ì˜ ë§¤ì„œë“œ í…ŒìŠ¤íŠ¸

> - Postman : JSON ë°ì´í„°ë¥¼ ì‰½ê²Œ í•¸ë“¤ë§í• ìˆ˜ ìˆëŠ” ì‘ìš© í”„ë¡œê·¸ë¨
> - ê°œë°œí•œ APIë¥¼ í…ŒìŠ¤íŠ¸í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ê³µìœ í•˜ì—¬ API ê°œë°œì˜ ìƒì‚°ì„±ì„ ë†’ì—¬ì¤Œ
>   [ì£¼ì†Œ í´ë¦­](https://www.postman.com/downloads/)

<br>

[ì„¤ì •í•œ RESTful API ë°”ë¡œ CRUD ê°€ëŠ¥]
![](./imgs/mvc/json_postman.png)

<br>
